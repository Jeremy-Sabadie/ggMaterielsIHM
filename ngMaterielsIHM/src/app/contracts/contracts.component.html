<div class="container">
  <h1>Gestion des Contrats</h1>

  <form [formGroup]="contractForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="name">Nom du Contrat</label>
      <input id="name" formControlName="name" type="text" placeholder="Nom du contrat" />
    </div>

    <div class="form-group">
      <label for="start_date">Date de Début</label>
      <input id="start_date" formControlName="start_date" type="date" />
    </div>

    <div class="form-group">
      <label for="end_date">Date de Fin</label>
      <input id="end_date" formControlName="end_date" type="date" />
    </div>

    <div class="button-group">
      <button type="submit" [class.btn-success]="!isEditMode" [class.btn-warning]="isEditMode"
        [class.btn-disabled]="!isValidForm()" [disabled]="!isValidForm()" [title]="getButtonTooltip()">
        {{ isEditMode ? 'Modifier' : 'Ajouter' }}
      </button>
      <button type="button" class="btn-info" (click)="resetForm()">Annuler</button>
    </div>

    <p *ngIf="!isValidForm()" class="error-message">
      ⚠️ Veuillez remplir tous les champs et vous assurer que la date de fin est postérieure à la date de début.
    </p>
  </form>

  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Date de Début</th>
        <th>Date de Fin</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let contract of contracts$ | async">
        <td>{{ contract.id }}</td>
        <td>{{ contract.name }}</td>
        <td>{{ contract.start_date | date: 'dd/MM/yyyy' }}</td>
        <td>{{ contract.end_date | date: 'dd/MM/yyyy' }}</td>
        <td class="actions">
          <div class="action-buttons">
            <button class="btn-warning" (click)="onEdit(contract)">Modifier</button>
            <button class="btn-danger" (click)="onDelete(contract.id)">Supprimer</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
